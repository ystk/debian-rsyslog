--- rsyslog-8.4.2.orig/plugins/pmaixforwardedfrom/pmaixforwardedfrom.c
+++ rsyslog-8.4.2/plugins/pmaixforwardedfrom/pmaixforwardedfrom.c
@@ -103,6 +103,10 @@ dbgprintf("not a AIX message forwarded f
 	}
 	/* bump the message portion up by 23 characters to overwrite the "Message forwarded from " with the hostname */
 	lenMsg -=23;
+	if(lenMsg < 2) {
+		dbgprintf("not a AIX message forwarded from message has nothing after header\n");
+		ABORT_FINALIZE(RS_RET_COULD_NOT_PARSE);
+	}
 	memmove(p2parse, p2parse + 23, lenMsg);
 	*(p2parse + lenMsg) = '\n';
 	*(p2parse + lenMsg + 1)  = '\0';
